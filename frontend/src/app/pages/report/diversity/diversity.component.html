<div class="dance-diversity-container">
      <div class="report-header">
        <h1>💃 Reporte de Diversidad de Baile</h1>
        <p class="subtitle">Análisis completo de estilos, niveles y combinaciones de baile</p>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading" class="loading-container">
        <div class="spinner"></div>
        <p>Cargando reporte de diversidad...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !loading" class="error-container">
        <p>❌ {{ error }}</p>
        <button (click)="loadReport()" class="retry-button">Reintentar</button>
      </div>

      <!-- Report Content -->
      <div *ngIf="!loading && !error && report" class="report-content">
        
        <!-- Métricas Generales -->
        <section class="general-stats">
          <h2>📊 Estadísticas Generales</h2>
          <div class="stats-grid">
            <div class="stat-card dancers">
              <div class="stat-icon">💃</div>
              <div class="stat-content">
                <h3>{{ report.totalActiveDancers | number }}</h3>
                <p>Bailarines Activos</p>
              </div>
            </div>
            
            <div class="stat-card avg-styles">
              <div class="stat-icon">🎭</div>
              <div class="stat-content">
                <h3>{{ report.averageStylesPerDancer | number:'1.1-1' }}</h3>
                <p>Promedio Estilos/Bailarín</p>
              </div>
            </div>
            
            <div class="stat-card total-styles">
              <div class="stat-icon">🌟</div>
              <div class="stat-content">
                <h3>{{ report.styleDistribution.length || 0 }}</h3>
                <p>Estilos Totales</p>
              </div>
            </div>
            
            <div class="stat-card combinations">
              <div class="stat-icon">🔄</div>
              <div class="stat-content">
                <h3>{{ report.topCombinations.length || 0 }}</h3>
                <p>Combinaciones Únicas</p>
              </div>
            </div>
          </div>
        </section>

        <!-- Distribución de Estilos -->
        <section class="style-distribution" *ngIf="report.styleDistribution?.length">
          <h2>🎵 Distribución de Estilos de Baile</h2>
          <div class="styles-grid">
            <div *ngFor="let style of report.styleDistribution; let i = index" 
                 class="style-card" 
                 [class]="'rank-' + (i + 1)">
              <div class="style-header">
                <div class="style-emoji">{{ getStyleEmoji(style.styleName) }}</div>
                <h3>{{ style.styleName }}</h3>
                <span class="rank-badge">#{{ i + 1 }}</span>
              </div>
              <div class="style-stats">
                <div class="count">{{ style.count | number }} bailarines</div>
                <div class="percentage">{{ style.percentage | number:'1.1-1' }}%</div>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="style.percentage"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- Distribución de Niveles -->
        <section class="level-distribution" *ngIf="report.levelDistribution?.length">
          <h2>📈 Distribución por Niveles</h2>
          <div class="levels-grid">
            <div *ngFor="let level of report.levelDistribution" 
                 class="level-card" 
                 [class]="level.levelName.toLowerCase()">
              <div class="level-header">
                <div class="level-icon">{{ getLevelIcon(level.levelName) }}</div>
                <h3>{{ level.levelName }}</h3>
              </div>
              <div class="level-stats">
                <div class="count">{{ level.count | number }}</div>
                <div class="percentage">{{ level.percentage | number:'1.1-1' }}%</div>
              </div>
              <div class="level-bar">
                <div class="level-fill" [style.width.%]="level.percentage"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- Top Combinaciones -->
        <section class="top-combinations" *ngIf="report.topCombinations?.length">
          <h2>🏆 Top Combinaciones de Estilos</h2>
          <div class="combinations-list">
            <div *ngFor="let combo of report.topCombinations.slice(0, 10); let i = index" 
                 class="combination-item">
              <div class="combo-rank">
                <span class="rank-number">{{ i + 1 }}</span>
              </div>
              <div class="combo-content">
                <div class="combo-name">{{ combo.combination }}</div>
                <div class="combo-stats">
                  <span class="combo-count">{{ combo.count | number }} bailarines</span>
                  <span class="combo-percentage">{{ combo.percentage | number:'1.1-1' }}%</span>
                </div>
              </div>
              <div class="combo-bar">
                <div class="combo-fill" [style.width.%]="combo.percentage"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- Estilos por Región -->
        <section class="regional-styles" *ngIf="report.stylesByRegion?.length">
          <h2>🗺️ Estilos por Región</h2>
          <div class="regions-container">
            <div *ngFor="let regional of getGroupedRegionalData()" class="region-group">
              <h3 class="region-name">{{ regional.region }}</h3>
              <div class="region-styles">
                <div *ngFor="let style of regional.styles" class="regional-style-item">
                  <div class="regional-style-header">
                    <span class="style-emoji">{{ getStyleEmoji(style.styleName) }}</span>
                    <span class="style-name">{{ style.styleName }}</span>
                  </div>
                  <div class="regional-style-stats">
                    <span class="count">{{ style.count | number }}</span>
                    <span class="percentage">{{ style.percentage | number:'1.1-1' }}%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Matriz Estilo-Nivel -->
        <section class="style-level-matrix" *ngIf="report.styleLevelStats?.length">
          <h2>📊 Matriz Estilo vs Nivel</h2>
          <div class="matrix-container">
            <div class="matrix-table">
              <div class="matrix-header">
                <div class="corner-cell"></div>
                <div *ngFor="let level of getUniqueLevels()" class="level-header-cell">
                  {{ level }}
                </div>
              </div>
              <div *ngFor="let style of getUniqueStyles()" class="matrix-row">
                <div class="style-header-cell">
                  <span class="style-emoji">{{ getStyleEmoji(style) }}</span>
                  {{ style }}
                </div>
                <div *ngFor="let level of getUniqueLevels()" 
                     class="matrix-cell"
                     [class.has-data]="getMatrixValue(style, level) > 0">
                  <div class="cell-content">
                    <div class="cell-count">{{ getMatrixValue(style, level) | number }}</div>
                    <div class="cell-percentage">{{ getMatrixPercentage(style, level) | number:'1.0-1' }}%</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- No Data Messages -->
        <div *ngIf="!report.styleDistribution?.length && !report.levelDistribution?.length" class="no-data">
          <p>📊 No hay datos de diversidad de baile para mostrar.</p>
        </div>
      </div>
    </div>
